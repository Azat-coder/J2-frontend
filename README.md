<div align="center">
  <h1>Проект "Автозаказ"</h1>
  <!-- <a href="https://path/"> -->
    <img src="public/favicon.svg" alt="logo Автозаказ">
  <!-- </a> -->
  <p>В данном файле описано устройство проекта и даны рекомендации по его развитию и поддержке. Этот файл должен актуализироваться руководителем группы разработки и дополняться новыми сведениями по мере развития проекта.</p>
</div>

## Содержание

- [Содержание](#содержание)
- [Инициализация](#инициализация)
- [Установка зависимостей](#установка-зависимостей)
- [Настройка хуков git](#настройка-хуков-git)
- [Локальный запуск](#локальный-запуск)
- [Запуск линтера](#запуск-линтера)
- [Правила Styleguide и рекомендации по стилю кода](#правила-styleguide-и-рекомендации-по-стилю-кода)
- [Именование веток в Git](#именование-веток-в-git)
- [Оформление коммитов](#оформление-коммитов)
- [Порядок проведения Code review](#порядок-проведения-code-review)
- [Создание релизной ветки перед деплоем](#создание-релизной-ветки-перед-деплоем)
- [Процесс деплоя](#процесс-деплоя)
- [Работа с TypeScript](#работа-с-typescript)

## Инициализация

Необходимо сгенерировать ssh ключ и добавить его в профиль. [Описание как это сделать](https://selectel.ru/blog/tutorials/how-to-generate-ssh/)

Чтобы скачать проект себе в локальную папку:
```sh
git clone git@gitlab.itnap.ru:goalprofit/autoordergroup/autoorder_v3_frontend.git
```
После этого должна появиться папка с названием проекта, в которой и будет вестись разработка.

## Установка зависимостей
```sh
npm install
```

## Настройка хуков git

После выполнения команды 
```sh
npm install
```
необходимо выполнить команду 
```sh
npm run setup:git-hooks
```

## Локальный запуск

Для локального запуска в режиме разработки необходимо выполнить команду
```sh
npm run dev
```

## Запуск линтера [ESLint](https://eslint.org/)

```sh
npm run lint
```

## Правила Styleguide и рекомендации по стилю кода

В качестве линтера в проекте используется ESLint с конфигурацией eslint-config-airbnb. Весь новый код на проекте должен быть написан в соответствии с этими правилами.

Старый код, не соответствующий стилю, будет переписываться по мере развития проекта и доработки соответствующих разделов.

Также необходимо использовать правила, рекомендованные командой разработки Vue: [Ссылка на источник](https://v3.ru.vuejs.org/style-guide) 

## Именование веток в Git

На проекте используется GitHubFlow. https://githubflow.github.io/

Дополнительные ветки (помимо master)(по мере движения по жизненному циклу проекта) именуются с добавлением префикса перед номером задачи в Jira:

* feature-[номер User Story/Epic в Jira] – ветки разработки нового блока функциональности в рамках User Story либо Epic. Не являются обязательными на проекте. Формируются из ветки master.
* task-[номер задачи в Jira] – ветка разработки в рамках конкретной задачи (sub-task) в Jira. Создается от ветки feature (если на проекте используются feature-ветки) либо напрямую из ветки master.
* release-[номер релиза] – ветка для тестирования функциональности следующего релиза. Формируются из ветки master и по окончании тестирования и исправления найденных дефектов сливается с master.
* hotfix-[номер хотфикса] – ветка с исправлениями дефектов, найденными в установленном Клиенту релизе. Не являются обязательными на проекте, их функцию могут выполнять ветки release. Формируются от ветки master и по окончании тестирования и исправления найденных дефектов сливается с master.
* bug-[номер задачи в Jira] – ветки исправления дефектов, найденные в ходе тестирования либо эксплуатации. Могут создаваться от веток hotfix (если баг найден на проде) и release (если баг найден при внутреннем тестировании) либо master (если выбран GitHubFlow).

Каждый commit message должен соответствовать формату conventional commits: "{префикс}: {номер задачи в Jira} - {понятное описание что реализовано в этом коммите}".

Возможные варианты префиксов:

* feat – если выполнялась разработка новой функицональности
* fix – если выполнялось исправление дефекта
* refactor – если выполнялся рефакторинг без изменения/исправления конечной функциональности
* docs – если выполнялось обновление документации либо *.md файлов
* build – изменения, связанные с механизмом сборки, например, обновление пакетов npm или nuget
* ci – изменение пайплайнов CI/CD
* style – исправление визуальной части либо форматирования, не связаны с изменением кода
* test – добавление недостающих тестов либо исправление существующих
* revert – откат внесенных ранее изменений

Описание состава должно позволять примерно понять состав изменений без просмотра изменений в файлах. Запрещено использовать в качестве commit message ничего не значащие слова и фразы вида "fix", "task work" и т.д.

В описании к merge request необходимо давать ссылку на задачу в Jira, в рамках которой открывается запрос на слияние. Если таких задач несколько, то необходимо давать ссылки на каждую задачу с новой строки.

**Пример**

```
Например AZ-192 (название задачи в Jira). Если несколько связанных задач выполняются в рамках одного технического задания, то создается одна ветка и называется по названию эпика в Jira.
Также перед каждый релизом создается отдельная ветка release-20 и в нее собираются все задачи.
```

## Оформление коммитов

Для начала необходимо корректно указать ваши данные в гите. После того как скачали проект откройте терминал в корне проекта и следуйте инструкции ниже:

```sh
# Обязательно укажите ваше реальное Имя и Фамилию. Никакие ники не допускаются.
$ git config user.name "John Doe"
# Также необходимо указать вашу корпоративную почту, которую вам должны были выдать (если нет, то обратитесь к вашему менеджеру).
$ git config user.email "johndoe@napoleonit.ru"
```
 Также на проекте используется определенный стиль коммитов. Пожалуйста следуйте ему. Это позволит в любое время по коду понять что было сделано или найти конкретную задачу:
```
Название задачи в Jira: что делает в рамках задачи в настоящем времени, начинаться с глагола на английском языке
```

**Пример**

```sh
$ git commit -m "feat: AZ-192: adds filtering logic"
```

## Порядок проведения Code review

После создания запроса на слияние (merge request) в системе контроля версий Git необходимо написать сообщение в чат Goalprofit Frontend в формате:  

```
@airgalin @ipetrov Ссылка на merge request
```
где указываются имена пользователей (теги) фронтенд - разработчиков на проекте и указывается ссылка на запрос на слияние. После чего указанные разработчики проводят code review и оставляют свои замечания в MR в комментариях на строке, на которой находится предполагаемая правка. Если замечаний нет, то ставится отметка Approve в системе контроля версий. В чате Goalprofit Frontend тегается составитель запроса и информируется об оставленных замечаниях или успешном прохождении ревью. Если на проекте меньше 4 разработчиков, то в ревью проводят все разработчики (например, если разработчика 3, то необходимо две отметки Approved). Если разработчиков больше, то количество разработчиков, участвующих в код ревью определяется руководителем группы разработки(но не менее двух). 

## Создание релизной ветки перед деплоем

Перед релизом необходимо подготовить релизную ветку. Если в релизе много отдельных задач, то нужно создать ветку release-номер-релиза:
```sh
git switch -c release-42
```
Если в релиз пойдет одна задача, то создавать релизную ветку нет необходимости.


## Процесс деплоя

В качестве сборщика модулей на проекте используется Vite. Команда для сборки приложения:
```sh
npm run build
```

## Работа с TypeScript

Сборка проекта в режиме build должна проходить без ошибок. При использовании комментариев @ts-nocheck и @ts-ignore необходимо добавлять комментарий, описывающий причину возникновения ошибки проверки типов, либо запись с пометкой TODO, для исправления ошибки в будущем  
```sh
// @ts-nocheck
// Lara presets do not have ts implementation yet
```
```sh
// @ts-nocheck
// TODO: type check fails, needs to be fixed
```
